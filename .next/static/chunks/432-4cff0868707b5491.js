"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[432],{1836:(e,s,t)=>{t.d(s,{P:()=>g});var l=t(5155),a=t(2115),r=t(8368),n=t(9580),i=t(1456),d=t(3),c=t(1654),o=t(5710),x=t(5998),m=t(6132),u=t(5917),h=t(7586),p=t(3327),b=t(4926);let g=e=>{let{children:s,currentUser:t,onLogout:g,onNavigate:f,currentView:N}=e,v=t.role===r.Xh.ADMIN,[w,y]=(0,a.useState)(!1),A=(0,a.useRef)(null),D=n.uY.filter(e=>e.userId===t.id),k=D.filter(e=>!e.isRead).length;return(0,a.useEffect)(()=>{let e=e=>{A.current&&!A.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,l.jsxs)("div",{className:"min-h-screen bg-slate-50 text-slate-900 font-sans flex flex-col",children:[(0,l.jsx)("header",{className:"sticky top-0 z-50 bg-white/95 backdrop-blur-md border-b border-slate-200 shadow-sm print:hidden",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,l.jsxs)("div",{className:"flex items-center gap-8",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer group",onClick:()=>f(v?"DASHBOARD_ADMIN":"DASHBOARD_STAKEHOLDER"),children:[(0,l.jsx)("div",{className:"w-9 h-9 bg-brand-500 rounded flex items-center justify-center shadow-sm group-hover:bg-brand-600 transition-colors",children:(0,l.jsx)("span",{className:"text-white font-bold text-sm tracking-wider",children:"CTT"})}),(0,l.jsxs)("div",{className:"hidden md:block",children:[(0,l.jsx)("span",{className:"font-bold text-lg tracking-tight text-slate-900 block leading-tight",children:"CTT"}),(0,l.jsx)("span",{className:"text-[10px] uppercase font-semibold text-slate-400 tracking-wider block leading-none",children:"Cuba Try Test"})]})]}),(0,l.jsx)("nav",{className:"hidden md:flex gap-1 ml-4 items-center",children:v?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j,{active:"DASHBOARD_ADMIN"===N,icon:(0,l.jsx)(i.A,{size:16}),label:"Dashboard",onClick:()=>f("DASHBOARD_ADMIN")}),(0,l.jsx)(j,{active:"ADMIN_TASK_MANAGEMENT"===N,icon:(0,l.jsx)(d.A,{size:16}),label:"Manage Tasks",onClick:()=>f("ADMIN_TASK_MANAGEMENT")}),(0,l.jsx)(j,{active:"IMPORT_WIZARD"===N,icon:(0,l.jsx)(c.A,{size:16}),label:"Import",onClick:()=>f("IMPORT_WIZARD")}),(0,l.jsx)(j,{active:"ADMIN_DATABASE"===N,icon:(0,l.jsx)(o.A,{size:16}),label:"Database",onClick:()=>f("ADMIN_DATABASE")})]}):null})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("div",{className:"relative",ref:A,children:[(0,l.jsxs)("button",{onClick:()=>y(!w),className:"p-2 rounded-full transition-colors relative ".concat(w?"bg-brand-50 text-brand-600":"text-slate-400 hover:text-brand-500 hover:bg-brand-50"),children:[(0,l.jsx)(x.A,{size:20}),k>0&&(0,l.jsx)("span",{className:"absolute top-1 right-1 w-2.5 h-2.5 bg-brand-500 rounded-full border-2 border-white"})]}),w&&(0,l.jsxs)("div",{className:"absolute right-0 mt-3 w-80 sm:w-96 bg-white rounded-xl shadow-xl border border-slate-100 ring-1 ring-black ring-opacity-5 animate-in fade-in slide-in-from-top-2 origin-top-right overflow-hidden",children:[(0,l.jsxs)("div",{className:"px-4 py-3 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center",children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:"Notifications"}),(0,l.jsx)("button",{className:"text-xs text-brand-600 hover:text-brand-700 font-medium",children:"Mark all read"})]}),(0,l.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:0===D.length?(0,l.jsx)("div",{className:"p-8 text-center text-slate-400",children:(0,l.jsx)("p",{className:"text-sm",children:"No new notifications"})}):(0,l.jsx)("div",{className:"divide-y divide-slate-50",children:D.map(e=>(0,l.jsxs)("div",{className:"p-4 hover:bg-slate-50 transition-colors flex gap-3 ".concat(e.isRead?"":"bg-brand-50/10"),children:[(0,l.jsxs)("div",{className:"mt-1 flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ".concat("ALERT"===e.type?"bg-rose-100 text-rose-600":"SUCCESS"===e.type?"bg-emerald-100 text-emerald-600":"MENTION"===e.type?"bg-blue-100 text-blue-600":"bg-slate-100 text-slate-500"),children:["ALERT"===e.type&&(0,l.jsx)(m.A,{size:14}),"SUCCESS"===e.type&&(0,l.jsx)(u.A,{size:14}),"MENTION"===e.type&&(0,l.jsx)(h.A,{size:14}),"INFO"===e.type&&(0,l.jsx)(p.A,{size:14})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-slate-800 leading-snug",children:e.message}),(0,l.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:e.time})]}),!e.isRead&&(0,l.jsx)("div",{className:"mt-2 w-2 h-2 rounded-full bg-brand-500 flex-shrink-0"})]},e.id))})}),(0,l.jsx)("div",{className:"p-2 border-t border-slate-100 text-center",children:(0,l.jsx)("button",{className:"text-xs text-slate-500 hover:text-slate-800 font-medium py-1",children:"View All History"})})]})]}),(0,l.jsx)("div",{className:"h-6 w-px bg-slate-200 mx-1"}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("div",{className:"text-right hidden sm:block",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-slate-900",children:t.name}),(0,l.jsxs)("p",{className:"text-xs text-slate-500",children:[t.countryCode," • ",t.role]})]}),(0,l.jsx)("img",{src:t.avatarUrl,alt:"User",className:"w-9 h-9 rounded-full border border-slate-200 shadow-sm object-cover"}),(0,l.jsx)("button",{onClick:g,className:"text-slate-400 hover:text-slate-800 ml-2",children:(0,l.jsx)(b.A,{size:18})})]})]})]})})}),(0,l.jsx)("main",{className:"flex-1 max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8",children:s})]})},j=e=>{let{active:s,icon:t,label:a,onClick:r}=e;return(0,l.jsxs)("button",{onClick:r,className:"flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all ".concat(s?"bg-slate-100 text-brand-600":"text-slate-500 hover:text-slate-800 hover:bg-slate-50"),children:[t,a]})}},4432:(e,s,t)=>{t.d(s,{default:()=>et});var l=t(5155),a=t(63),r=t(2115),n=t(6489),i=t(1836),d=t(8368),c=t(9580);let o=e=>{let{type:s,value:t,className:a=""}=e;return"status"===s?(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case d.nW.PENDING:return"bg-slate-100 text-slate-600 border-slate-200";case d.nW.IN_PROGRESS:return"bg-blue-50 text-blue-700 border-blue-100";case d.nW.PASSED:return"bg-emerald-50 text-emerald-700 border-emerald-100";case d.nW.FAILED:return"bg-rose-50 text-rose-700 border-rose-100";case d.nW.BLOCKED:return"bg-amber-50 text-amber-700 border-amber-100";default:return"bg-gray-100 text-gray-600"}})(t)," ").concat(a),children:t}):"priority"===s?(0,l.jsxs)("span",{className:"text-xs flex items-center gap-1 ".concat((e=>{switch(e){case d.bx.LOW:return"text-slate-500";case d.bx.MEDIUM:return"text-blue-600";case d.bx.HIGH:return"text-amber-600 font-medium";case d.bx.CRITICAL:return"text-rose-600 font-bold";default:return"text-slate-500"}})(t)," ").concat(a),children:[t===d.bx.CRITICAL&&(0,l.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-rose-500 animate-pulse"}),t===d.bx.HIGH&&(0,l.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-amber-500"}),t]}):"module"===s?(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-50 text-indigo-700 border border-indigo-100 ".concat(a),children:t}):(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-600 ".concat(a),children:t})};var x=t(6132),m=t(2529),u=t(6983),h=t(7586),p=t(2987),b=t(6651);let g=e=>{let{tasks:s,onSelectTask:t,currentUserCountry:a}=e,[n,i]=(0,r.useState)("All"),g=s.filter(e=>e.countryCode===a),j="All"===n?g:g.filter(e=>e.status===n),f=g.length,N=g.filter(e=>e.status===d.nW.PENDING||e.status===d.nW.IN_PROGRESS).length,v=g.filter(e=>e.status===d.nW.PASSED).length,w=f>0?Math.round(v/f*100):0,y=Math.round(.2*g.reduce((e,s)=>{var t;return e+(null!=(t=s.steps)?t:[]).reduce((e,s)=>{var t,l;return e+(null!=(l=null==(t=s.comments)?void 0:t.length)?l:0)},0)},0)),A=g.filter(e=>e.status===d.nW.BLOCKED),D=c.uY.filter(e=>"MENTION"===e.type||"ALERT"===e.type).slice(0,5),k=e=>{var s;return null==(s=e.assignee)?void 0:s.avatarUrl};return(0,l.jsxs)("div",{className:"space-y-6",children:[A.length>0&&(0,l.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 flex items-start gap-3 animate-fade-in shadow-sm",children:[(0,l.jsx)(x.A,{className:"text-amber-600 mt-0.5 flex-shrink-0",size:24}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"font-bold text-sm text-amber-900",children:["Attention Needed: Testing Halted for ",A.length," Tasks"]}),(0,l.jsx)("p",{className:"text-amber-800 text-sm mt-1 mb-2",children:"The following tasks are currently blocked. Please focus on other scenarios."}),(0,l.jsx)("ul",{className:"list-disc list-inside text-xs text-amber-700 space-y-1",children:A.map(e=>(0,l.jsxs)("li",{children:[(0,l.jsxs)("span",{className:"font-semibold",children:[e.featureModule,":"]})," ",e.title," ",e.blockReason?"(".concat(e.blockReason,")"):""]},e.id))})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,l.jsxs)("div",{className:"lg:col-span-3 space-y-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Hello, Sarah"}),(0,l.jsxs)("p",{className:"text-slate-500 mt-1",children:["Here is the testing progress for ",a,"."]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-5 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,l.jsx)("span",{className:"text-sm font-medium text-slate-500 uppercase tracking-wide",children:"Progress"}),(0,l.jsx)(m.A,{size:20,className:"text-brand-600"})]}),(0,l.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,l.jsxs)("span",{className:"text-3xl font-bold text-slate-900",children:[w,"%"]}),(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"completed"})]}),(0,l.jsx)("div",{className:"w-full bg-slate-100 rounded-full h-1.5 mt-3 overflow-hidden",children:(0,l.jsx)("div",{className:"bg-brand-500 h-1.5 rounded-full",style:{width:"".concat(w,"%")}})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-5 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,l.jsx)("span",{className:"text-sm font-medium text-slate-500 uppercase tracking-wide",children:"Open Tasks"}),(0,l.jsx)(u.A,{size:20,className:"text-blue-500"})]}),(0,l.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,l.jsx)("span",{className:"text-3xl font-bold text-slate-900",children:N}),(0,l.jsx)("span",{className:"text-xs text-slate-400",children:"remaining"})]}),(0,l.jsx)("p",{className:"text-xs text-slate-400 mt-3",children:"Due this week"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 p-5 shadow-sm relative overflow-hidden",children:[(0,l.jsx)("div",{className:"absolute top-0 right-0 w-16 h-16 bg-purple-50 rounded-bl-full -mr-8 -mt-8 z-0"}),(0,l.jsxs)("div",{className:"relative z-10",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,l.jsx)("span",{className:"text-sm font-medium text-slate-500 uppercase tracking-wide",children:"Unread"}),(0,l.jsx)(h.A,{size:20,className:"text-purple-600"})]}),(0,l.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,l.jsx)("span",{className:"text-3xl font-bold text-purple-900",children:y}),(0,l.jsx)("span",{className:"text-xs text-purple-600 font-medium",children:"new comments"})]}),(0,l.jsxs)("button",{className:"text-xs text-purple-700 hover:text-purple-900 font-medium mt-3 flex items-center gap-1",children:["View Discussions ",(0,l.jsx)(p.A,{size:12})]})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center bg-white p-2 rounded-lg border border-slate-200 shadow-sm mb-6",children:[(0,l.jsx)("div",{className:"flex gap-1 bg-slate-100 p-1 rounded-md overflow-x-auto max-w-full",children:["All",d.nW.PENDING,d.nW.IN_PROGRESS,d.nW.PASSED,d.nW.BLOCKED].map(e=>(0,l.jsx)("button",{onClick:()=>i(e),className:"px-4 py-1.5 text-sm font-medium rounded-md whitespace-nowrap transition-all ".concat(n===e?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"),children:e},e))}),(0,l.jsxs)("div",{className:"relative mt-2 sm:mt-0 w-full sm:w-64",children:[(0,l.jsx)(b.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16}),(0,l.jsx)("input",{type:"text",placeholder:"Search tasks...",className:"w-full pl-9 pr-4 py-2 text-sm border-none bg-transparent focus:ring-0 placeholder-slate-400 text-slate-800"})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:0===j.length?(0,l.jsx)("div",{className:"col-span-full text-center py-20 bg-white rounded-xl border border-dashed border-slate-200",children:(0,l.jsx)("p",{className:"text-slate-400",children:"No tasks found matching your filters."})}):j.map(e=>{var s,a;return(0,l.jsxs)("div",{onClick:()=>t(e),className:"group bg-white rounded-xl p-5 border border-slate-200 shadow-sm hover:shadow-md hover:border-brand-200 transition-all cursor-pointer relative overflow-hidden flex flex-col h-full",children:[(0,l.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 ".concat(e.status===d.nW.PASSED?"bg-emerald-500":e.status===d.nW.FAILED?"bg-rose-500":e.status===d.nW.BLOCKED?"bg-amber-500":e.status===d.nW.IN_PROGRESS?"bg-blue-500":"bg-slate-300")}),(0,l.jsxs)("div",{className:"flex justify-between items-start mb-3 pt-2",children:[(0,l.jsx)(o,{type:"module",value:e.featureModule}),(0,l.jsx)(o,{type:"status",value:e.status})]}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900 group-hover:text-brand-600 transition-colors mb-2 line-clamp-2",children:e.title}),(0,l.jsx)("p",{className:"text-slate-500 text-sm line-clamp-2 mb-4 flex-1",children:e.description}),(0,l.jsxs)("div",{className:"border-t border-slate-100 pt-3 mt-auto flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[k(e)?(0,l.jsx)("img",{src:k(e),alt:"Assignee",className:"w-6 h-6 rounded-full border border-slate-200"}):(0,l.jsx)("div",{className:"w-6 h-6 rounded-full bg-slate-200 flex items-center justify-center text-[10px] font-bold text-slate-500",children:"?"}),(0,l.jsx)("span",{className:"text-xs text-slate-600 font-medium",children:(e=>{var s,t;return(null==(s=e.assignee)?void 0:s.name)?e.assignee.name:(null==(t=e.assignee)?void 0:t.email)?e.assignee.email:e.assigneeId?e.assigneeId:"Unassigned"})(e)})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(null!=(s=e.steps)?s:[]).reduce((e,s)=>{var t,l;return e+(null!=(l=null==(t=s.comments)?void 0:t.length)?l:0)},0)>0&&(0,l.jsxs)("span",{className:"flex items-center text-xs text-slate-400 gap-1",children:[(0,l.jsx)(h.A,{size:12})," ",(null!=(a=e.steps)?a:[]).reduce((e,s)=>{var t,l;return e+(null!=(l=null==(t=s.comments)?void 0:t.length)?l:0)},0)]}),(0,l.jsx)(o,{type:"priority",value:e.priority})]})]})]},e.id)})})]})]}),(0,l.jsx)("div",{className:"hidden lg:block space-y-6",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-5 sticky top-24",children:[(0,l.jsx)("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-wide mb-4",children:"Recent Activity"}),(0,l.jsxs)("div",{className:"space-y-6",children:[0===D.length?(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"No recent activity."}):D.map(e=>(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsx)("div",{className:"mt-0.5 min-w-[24px]",children:(0,l.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ".concat("ALERT"===e.type?"bg-rose-100 text-rose-600":"bg-blue-100 text-blue-600"),children:"ALERT"===e.type?"!":"@"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-slate-700 leading-snug",children:e.message}),(0,l.jsx)("span",{className:"text-xs text-slate-400 block mt-1",children:e.time})]})]},e.id)),(0,l.jsxs)("div",{className:"pt-4 border-t border-slate-100",children:[(0,l.jsx)("h4",{className:"text-xs font-semibold text-slate-500 uppercase mb-2",children:"Helpful Links"}),(0,l.jsxs)("ul",{className:"space-y-2",children:[(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"#",className:"text-sm text-brand-600 hover:underline",children:"UAT Guidelines PDF"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"#",className:"text-sm text-brand-600 hover:underline",children:"Report a System Bug"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"#",className:"text-sm text-brand-600 hover:underline",children:"Contact Admin"})})]})]})]})]})})]})]})};var j=t(1524),f=t(2056),N=t(8874);let v=e=>{let{tasks:s,onSelectTask:t,onManageTasks:a}=e,r=s.length,n=Math.round(s.filter(e=>e.status===d.nW.PASSED||e.status===d.nW.DEPLOYED).length/r*100)||0,i=s.filter(e=>e.status===d.nW.PENDING||e.status===d.nW.IN_PROGRESS).length,c=s.filter(e=>e.status===d.nW.BLOCKED||e.status===d.nW.FAILED).length,x=Math.round(.3*s.reduce((e,s)=>{var t;return e+(null!=(t=s.steps)?t:[]).reduce((e,s)=>{var t,l;return e+(null!=(l=null==(t=s.comments)?void 0:t.length)?l:0)},0)},0)),m=[...s].sort((e,s)=>{let t=e=>e===d.nW.BLOCKED||e===d.nW.FAILED?3:e===d.nW.IN_PROGRESS?2:+(e===d.nW.PENDING);return t(s.status)-t(e.status)}).slice(0,5);return(0,l.jsxs)("div",{className:"space-y-8 animate-fade-in",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:"Admin Dashboard"}),(0,l.jsx)("p",{className:"text-slate-500",children:"Monitor overall progress and address blockers."})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{onClick:a,className:"px-4 py-2 bg-white border border-slate-200 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 shadow-sm",children:"Manage Tasks"}),(0,l.jsx)("button",{onClick:a,className:"px-4 py-2 bg-slate-900 text-white rounded-lg text-sm font-medium hover:bg-slate-800 shadow-sm flex items-center gap-2",children:"+ New Task"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,l.jsx)("span",{className:"text-slate-500 text-sm font-medium",children:"Overall Progress"}),(0,l.jsx)(j.A,{size:20,className:"text-brand-600"})]}),(0,l.jsxs)("div",{className:"flex items-end gap-2",children:[(0,l.jsxs)("span",{className:"text-3xl font-bold text-slate-900",children:[n,"%"]}),(0,l.jsx)("span",{className:"text-xs text-slate-400 mb-1",children:"completion"})]}),(0,l.jsx)("div",{className:"w-full bg-slate-100 h-1.5 rounded-full mt-3 overflow-hidden",children:(0,l.jsx)("div",{className:"bg-brand-600 h-1.5 rounded-full",style:{width:"".concat(n,"%")}})})]}),(0,l.jsxs)("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,l.jsx)("span",{className:"text-slate-500 text-sm font-medium",children:"Open UAT Tasks"}),(0,l.jsx)(u.A,{size:20,className:"text-blue-500"})]}),(0,l.jsx)("span",{className:"text-3xl font-bold text-slate-900",children:i}),(0,l.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:"Pending or In Progress"})]}),(0,l.jsxs)("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,l.jsx)("span",{className:"text-slate-500 text-sm font-medium",children:"Blockers / Failed"}),(0,l.jsx)(f.A,{size:20,className:"text-amber-500"})]}),(0,l.jsx)("span",{className:"text-3xl font-bold ".concat(c>0?"text-amber-600":"text-slate-900"),children:c}),(0,l.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:"Requires attention"})]}),(0,l.jsxs)("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,l.jsx)("span",{className:"text-slate-500 text-sm font-medium",children:"Unread Comments"}),(0,l.jsx)(h.A,{size:20,className:"text-purple-500"})]}),(0,l.jsx)("span",{className:"text-3xl font-bold text-slate-900",children:x}),(0,l.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:"From stakeholders"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,l.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h3",{className:"font-bold text-slate-900",children:"Priority Tasks (Open & Issues)"}),(0,l.jsx)("span",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-1 rounded",children:"Sorted by Urgency"})]}),(0,l.jsx)("div",{className:"space-y-4",children:m.map(e=>{var s,a;return(0,l.jsxs)("div",{onClick:()=>t(e),className:"bg-white rounded-xl p-5 border border-slate-200 shadow-sm hover:border-brand-300 transition-all cursor-pointer group",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(o,{type:"module",value:e.featureModule}),(0,l.jsx)("span",{className:"text-xs text-slate-500 font-medium bg-slate-100 px-2 py-0.5 rounded-full",children:e.countryCode})]}),(0,l.jsx)("h4",{className:"font-semibold text-slate-900 group-hover:text-brand-600",children:e.title}),(0,l.jsx)("p",{className:"text-sm text-slate-500 line-clamp-1",children:e.description})]}),(0,l.jsx)(o,{type:"status",value:e.status})]}),(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-100 flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4 text-xs text-slate-500",children:[(0,l.jsxs)("span",{children:["Assignee: ",(0,l.jsx)("strong",{children:(null==(s=e.assignee)?void 0:s.name)||(null==(a=e.assignee)?void 0:a.email)||e.assigneeId||"Unassigned"})]}),(0,l.jsxs)("span",{children:["Due: ",e.dueDate]})]}),(0,l.jsx)(p.A,{size:18,className:"text-slate-300 group-hover:text-brand-500"})]})]},e.id)})}),(0,l.jsx)("button",{onClick:a,className:"w-full py-3 text-sm text-slate-500 font-medium hover:text-brand-600 hover:bg-slate-50 border border-dashed border-slate-200 rounded-xl transition-colors",children:"View All Tasks"})]}),(0,l.jsx)("div",{className:"space-y-6",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[(0,l.jsxs)("h3",{className:"font-bold text-slate-900 mb-4 flex items-center gap-2",children:[(0,l.jsx)(f.A,{size:18,className:"text-amber-500"})," Critical Issues"]}),(0,l.jsx)("div",{className:"space-y-3",children:0===s.filter(e=>e.status===d.nW.FAILED||e.status===d.nW.BLOCKED).length?(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"No critical issues found."}):s.filter(e=>e.status===d.nW.FAILED||e.status===d.nW.BLOCKED).map(e=>(0,l.jsxs)("div",{onClick:()=>t(e),className:"flex items-start gap-3 p-3 bg-red-50/50 rounded-lg border border-red-100 hover:bg-red-50 cursor-pointer transition-colors",children:[(0,l.jsx)(N.A,{size:16,className:"text-red-500 mt-0.5 flex-shrink-0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs font-bold text-red-800 line-clamp-1",children:e.title}),(0,l.jsxs)("p",{className:"text-[10px] text-red-600 mt-0.5",children:[e.countryCode," • ",e.status]})]})]},e.id))})]})})]})]})};var w=t(1654),y=t(6191),A=t(6955),D=t(1190),k=t(1360),S=t(5229),C=t(9068),I=t(3665);let E=e=>{let{tasks:s,onImport:t,onEdit:a,onAddTask:n,availableCountries:i,availableModules:x}=e,[m,u]=(0,r.useState)(""),[h,p]=(0,r.useState)(!1),[g,j]=(0,r.useState)({title:"",description:"",featureModule:"Ordering",priority:d.bx.MEDIUM,assigneeId:c.o1[0].id,dueDate:"",scope:"Local",targetSystem:"Ordering Portal",crNumber:""}),[f,N]=(0,r.useState)(["SG"]),[v,E]=(0,r.useState)([{id:"1",description:"",expectedResult:"",countryFilter:"ALL",testData:""}]),T=s.filter(e=>e.title.toLowerCase().includes(m.toLowerCase())||e.featureModule.toLowerCase().includes(m.toLowerCase())),R=(e,s,t)=>{let l=[...v];l[e]={...l[e],[s]:t},E(l)};return(0,l.jsxs)("div",{className:"space-y-6 animate-fade-in relative",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Task Management"}),(0,l.jsx)("p",{className:"text-slate-500",children:"Create, edit, and organize UAT scenarios."})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("button",{onClick:t,className:"px-4 py-2 bg-white border border-slate-200 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 shadow-sm flex items-center gap-2",children:[(0,l.jsx)(w.A,{size:16})," Import Excel"]}),(0,l.jsxs)("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-slate-900 text-white rounded-lg text-sm font-medium hover:bg-slate-800 shadow-sm flex items-center gap-2",children:[(0,l.jsx)(y.A,{size:16})," New Task"]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"p-4 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[(0,l.jsxs)("div",{className:"relative max-w-sm w-full",children:[(0,l.jsx)(b.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16}),(0,l.jsx)("input",{type:"text",className:"w-full pl-9 pr-4 py-2 text-sm border-slate-300 rounded-lg focus:ring-slate-500 focus:border-slate-500",placeholder:"Search tasks...",value:m,onChange:e=>u(e.target.value)})]}),(0,l.jsx)("button",{className:"p-2 text-slate-500 hover:bg-slate-200 rounded-lg",children:(0,l.jsx)(A.A,{size:18})})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,l.jsx)("thead",{className:"bg-slate-50 text-slate-500 font-medium border-b border-slate-200",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-4",children:"Task Title"}),(0,l.jsx)("th",{className:"px-6 py-4",children:"Module"}),(0,l.jsx)("th",{className:"px-6 py-4",children:"Country"}),(0,l.jsx)("th",{className:"px-6 py-4",children:"Status"}),(0,l.jsx)("th",{className:"px-6 py-4",children:"Priority"}),(0,l.jsx)("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-100",children:T.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors",children:[(0,l.jsx)("td",{className:"px-6 py-4 font-medium text-slate-900",children:e.title}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)(o,{type:"module",value:e.featureModule})}),(0,l.jsx)("td",{className:"px-6 py-4",children:e.countryCode}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)(o,{type:"status",value:e.status})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)(o,{type:"priority",value:e.priority})}),(0,l.jsx)("td",{className:"px-6 py-4 text-right",children:(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,l.jsx)("button",{onClick:()=>a(e),className:"p-1.5 text-slate-500 hover:text-brand-600 hover:bg-brand-50 rounded",children:(0,l.jsx)(D.A,{size:16})}),(0,l.jsx)("button",{className:"p-1.5 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded",children:(0,l.jsx)(k.A,{size:16})})]})})]},e.id))})]})}),(0,l.jsxs)("div",{className:"p-4 border-t border-slate-200 bg-slate-50 text-xs text-slate-500 text-center",children:["Showing ",T.length," tasks"]})]}),h&&(0,l.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl animate-in zoom-in-95 my-8",children:[(0,l.jsxs)("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50 rounded-t-xl",children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-slate-900",children:"Create New Task"}),(0,l.jsx)("button",{onClick:()=>p(!1),className:"text-slate-400 hover:text-slate-600",children:(0,l.jsx)(S.A,{size:20})})]}),(0,l.jsxs)("div",{className:"p-6 space-y-6 max-h-[70vh] overflow-y-auto",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Title"}),(0,l.jsx)("input",{type:"text",className:"w-full rounded-md border-slate-300 focus:ring-slate-500 focus:border-slate-500 text-sm",placeholder:"e.g. Verify Cart Calculation",value:g.title,onChange:e=>j({...g,title:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Target System"}),(0,l.jsxs)("select",{className:"w-full rounded-md border-slate-300 focus:ring-slate-500 focus:border-slate-500 text-sm",value:g.targetSystem,onChange:e=>j({...g,targetSystem:e.target.value}),children:[(0,l.jsx)("option",{value:"Ordering Portal",children:"Ordering Portal"}),(0,l.jsx)("option",{value:"Admin Portal",children:"Admin Portal"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Module"}),(0,l.jsx)("select",{className:"w-full rounded-md border-slate-300 focus:ring-slate-500 focus:border-slate-500 text-sm",value:g.featureModule,onChange:e=>j({...g,featureModule:e.target.value}),children:x.map(e=>(0,l.jsx)("option",{children:e},e))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Priority"}),(0,l.jsxs)("select",{className:"w-full rounded-md border-slate-300 focus:ring-slate-500 focus:border-slate-500 text-sm",value:g.priority,onChange:e=>j({...g,priority:e.target.value}),children:[(0,l.jsx)("option",{value:d.bx.LOW,children:"Low"}),(0,l.jsx)("option",{value:d.bx.MEDIUM,children:"Medium"}),(0,l.jsx)("option",{value:d.bx.HIGH,children:"High"}),(0,l.jsx)("option",{value:d.bx.CRITICAL,children:"Critical"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"CR No (Optional)"}),(0,l.jsx)("input",{type:"text",className:"w-full rounded-md border-slate-300 focus:ring-slate-500 focus:border-slate-500 text-sm",placeholder:"e.g. CR-123",value:g.crNumber,onChange:e=>j({...g,crNumber:e.target.value})})]})]}),(0,l.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[(0,l.jsx)(C.A,{size:16})," Assign Countries (Multi-select)"]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:i.map(e=>{let s=f.includes(e.code);return(0,l.jsxs)("button",{onClick:()=>(e=>{f.includes(e)?f.length>1&&N(f.filter(s=>s!==e)):N([...f,e])})(e.code),className:"px-3 py-1 rounded-full text-xs font-medium border transition-all ".concat(s?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-600 border-slate-300 hover:border-slate-400"),children:[e.name," ",s&&"✓"]},e.code)})}),(0,l.jsx)("p",{className:"text-[10px] text-slate-500 mt-2",children:"A separate task instance will be created for each selected country."})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),(0,l.jsx)("textarea",{className:"w-full rounded-md border-slate-300 focus:ring-slate-500 focus:border-slate-500 text-sm h-20",placeholder:"Description of the test case...",value:g.description,onChange:e=>j({...g,description:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Due Date"}),(0,l.jsx)("input",{type:"date",className:"w-full rounded-md border-slate-300 focus:ring-slate-500 focus:border-slate-500 text-sm",value:g.dueDate,onChange:e=>j({...g,dueDate:e.target.value})})]})]}),(0,l.jsxs)("div",{className:"border-t border-slate-100 pt-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-900 text-sm",children:"Test Steps"}),(0,l.jsxs)("button",{type:"button",onClick:()=>{E([...v,{id:"".concat(v.length+1),description:"",expectedResult:"",countryFilter:"ALL",testData:""}])},className:"text-xs text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1",children:[(0,l.jsx)(y.A,{size:12})," Add Step"]})]}),(0,l.jsxs)("div",{className:"bg-slate-50 rounded-lg border border-slate-200 overflow-hidden",children:[(0,l.jsxs)("div",{className:"grid grid-cols-12 gap-0 text-xs font-semibold text-slate-500 bg-slate-100 border-b border-slate-200 p-2",children:[(0,l.jsx)("div",{className:"col-span-1 text-center",children:"#"}),(0,l.jsx)("div",{className:"col-span-3",children:"Description"}),(0,l.jsx)("div",{className:"col-span-3",children:"Expected Result"}),(0,l.jsx)("div",{className:"col-span-2",children:"Test Data"}),(0,l.jsx)("div",{className:"col-span-2",children:"Applicable To"}),(0,l.jsx)("div",{className:"col-span-1"})]}),(0,l.jsx)("div",{className:"divide-y divide-slate-200",children:v.map((e,s)=>(0,l.jsxs)("div",{className:"grid grid-cols-12 gap-2 p-2 items-start hover:bg-white transition-colors",children:[(0,l.jsx)("div",{className:"col-span-1 flex items-center justify-center pt-2",children:(0,l.jsx)("span",{className:"w-5 h-5 rounded-full bg-slate-200 text-slate-500 text-xs flex items-center justify-center font-bold",children:s+1})}),(0,l.jsx)("div",{className:"col-span-3",children:(0,l.jsx)("textarea",{placeholder:"Step Action",className:"w-full text-xs border-slate-300 rounded focus:ring-slate-500 focus:border-slate-500",rows:2,value:e.description,onChange:e=>R(s,"description",e.target.value)})}),(0,l.jsx)("div",{className:"col-span-3",children:(0,l.jsx)("textarea",{placeholder:"Expected Result",className:"w-full text-xs border-slate-300 rounded focus:ring-slate-500 focus:border-slate-500",rows:2,value:e.expectedResult,onChange:e=>R(s,"expectedResult",e.target.value)})}),(0,l.jsx)("div",{className:"col-span-2",children:(0,l.jsx)("input",{placeholder:"Input data...",className:"w-full text-xs border-slate-300 rounded focus:ring-slate-500 focus:border-slate-500",value:e.testData,onChange:e=>R(s,"testData",e.target.value)})}),(0,l.jsx)("div",{className:"col-span-2",children:(0,l.jsxs)("select",{className:"w-full text-xs border-slate-300 rounded focus:ring-slate-500 focus:border-slate-500",value:e.countryFilter||"ALL",onChange:e=>R(s,"countryFilter",e.target.value),children:[(0,l.jsx)("option",{value:"ALL",children:"All Selected"}),f.map(e=>(0,l.jsxs)("option",{value:e,children:[e," Only"]},e))]})}),(0,l.jsx)("div",{className:"col-span-1 flex justify-center pt-2",children:(0,l.jsx)("button",{onClick:()=>(e=>{let s=[...v];s.splice(e,1),E(s)})(s),className:"text-slate-400 hover:text-red-500",children:(0,l.jsx)(k.A,{size:14})})})]},s))})]})]})]}),(0,l.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-100 rounded-b-xl flex justify-end gap-3",children:[(0,l.jsx)("button",{onClick:()=>p(!1),className:"px-4 py-2 text-slate-600 hover:text-slate-800 text-sm font-medium",children:"Cancel"}),(0,l.jsxs)("button",{onClick:()=>{if(!g.title)return;let e=[];f.forEach(s=>{let t=v.filter(e=>"ALL"===e.countryFilter||e.countryFilter===s);if(0===t.length)return;let l={id:"t_".concat(Date.now(),"_").concat(s),title:g.title||"Untitled",description:g.description||"",featureModule:g.featureModule||"General",status:d.nW.PENDING,priority:g.priority||d.bx.MEDIUM,countryCode:s,assigneeId:g.assigneeId||"u1",dueDate:g.dueDate||new Date().toISOString().split("T")[0],scope:g.scope||"Local",targetSystem:g.targetSystem||"Ordering Portal",crNumber:g.crNumber,steps:t.map((e,t)=>({id:"s_".concat(Date.now(),"_").concat(s,"_").concat(t),description:e.description||"",expectedResult:e.expectedResult||"",testData:e.testData||"",isPassed:null,comments:[]})),updatedAt:"Just now"};e.push(l)}),n(e),p(!1),j({featureModule:"Ordering",priority:d.bx.MEDIUM,targetSystem:"Ordering Portal"}),N(["SG"]),E([{id:"1",description:"",expectedResult:"",countryFilter:"ALL",testData:""}])},className:"px-4 py-2 bg-slate-900 text-white rounded-md hover:bg-slate-800 text-sm font-medium flex items-center gap-2",children:[(0,l.jsx)(I.A,{size:16})," Create ",f.length," Tasks"]})]})]})})]})};var T=t(6617);let R=e=>{let{countries:s,modules:t,onUpdateCountries:a,onUpdateModules:n}=e,[i,d]=(0,r.useState)("countries"),[c,o]=(0,r.useState)(""),[x,m]=(0,r.useState)(""),[u,h]=(0,r.useState)("");return(0,l.jsxs)("div",{className:"max-w-4xl mx-auto animate-fade-in",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"System Database"}),(0,l.jsx)("p",{className:"text-slate-500",children:"Manage Master Data and List of Values."})]}),(0,l.jsxs)("div",{className:"flex gap-4 mb-6 border-b border-slate-200",children:[(0,l.jsx)("button",{onClick:()=>d("countries"),className:"pb-3 px-4 text-sm font-medium transition-colors border-b-2 ".concat("countries"===i?"border-slate-900 text-slate-900":"border-transparent text-slate-500 hover:text-slate-700"),children:"Countries"}),(0,l.jsx)("button",{onClick:()=>d("modules"),className:"pb-3 px-4 text-sm font-medium transition-colors border-b-2 ".concat("modules"===i?"border-slate-900 text-slate-900":"border-transparent text-slate-500 hover:text-slate-700"),children:"Modules"})]}),"countries"===i&&(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[(0,l.jsxs)("div",{className:"flex gap-3 mb-6 items-end bg-slate-50 p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Country Name"}),(0,l.jsx)("input",{type:"text",className:"w-full mt-1 border-slate-300 rounded-md text-sm",placeholder:"e.g. Indonesia",value:c,onChange:e=>o(e.target.value)})]}),(0,l.jsxs)("div",{className:"w-32",children:[(0,l.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Code"}),(0,l.jsx)("input",{type:"text",className:"w-full mt-1 border-slate-300 rounded-md text-sm uppercase",placeholder:"ID",maxLength:2,value:x,onChange:e=>m(e.target.value)})]}),(0,l.jsxs)("button",{onClick:()=>{c&&x&&(a([...s,{name:c,code:x.toUpperCase(),color:"bg-slate-100 text-slate-600"}]),o(""),m(""))},className:"bg-slate-900 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-slate-800 flex items-center gap-2 h-[38px]",children:[(0,l.jsx)(y.A,{size:16})," Add"]})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(e=>(0,l.jsxs)("div",{className:"flex justify-between items-center p-3 border border-slate-200 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-600 font-bold text-xs",children:e.code}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.name})]}),(0,l.jsx)("button",{onClick:()=>{var t;return t=e.code,void a(s.filter(e=>e.code!==t))},className:"text-slate-400 hover:text-red-500 p-1",children:(0,l.jsx)(k.A,{size:16})})]},e.code))})]}),"modules"===i&&(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[(0,l.jsxs)("div",{className:"flex gap-3 mb-6 items-end bg-slate-50 p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Module Name"}),(0,l.jsx)("input",{type:"text",className:"w-full mt-1 border-slate-300 rounded-md text-sm",placeholder:"e.g. Logistics",value:u,onChange:e=>h(e.target.value)})]}),(0,l.jsxs)("button",{onClick:()=>{u&&!t.includes(u)&&(n([...t,u]),h(""))},className:"bg-slate-900 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-slate-800 flex items-center gap-2 h-[38px]",children:[(0,l.jsx)(y.A,{size:16})," Add"]})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.map(e=>(0,l.jsxs)("div",{className:"flex justify-between items-center p-3 border border-slate-200 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)(T.A,{size:18,className:"text-slate-400"}),(0,l.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e})]}),(0,l.jsx)("button",{onClick:()=>{n(t.filter(s=>s!==e))},className:"text-slate-400 hover:text-red-500 p-1",children:(0,l.jsx)(k.A,{size:16})})]},e))})]})]})};var P=t(9295);let M=e=>{let{onEnd:s}=e,t=(0,r.useRef)(null),[a,n]=(0,r.useState)(!1),[i,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=t.current;if(!e)return;e.width=e.offsetWidth,e.height=e.offsetHeight;let s=e.getContext("2d");s&&(s.lineWidth=2,s.lineCap="round",s.strokeStyle="#0f172a");let l=()=>{let t=e.toDataURL();e.width=e.offsetWidth,e.height=e.offsetHeight;let l=new Image;l.src=t,l.onload=()=>null==s?void 0:s.drawImage(l,0,0)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]);let c=()=>{n(!1),t.current&&s(t.current.toDataURL())},o=e=>{let s,l;if(!a)return;let r=t.current,n=null==r?void 0:r.getContext("2d");if(!r||!n)return;let c=r.getBoundingClientRect();"touches"in e?(s=e.touches[0].clientX,l=e.touches[0].clientY):(s=e.clientX,l=e.clientY);let o=s-c.left,x=l-c.top;n.lineTo(o,x),n.stroke(),n.beginPath(),n.moveTo(o,x),i||d(!0)},x=e=>{n(!0);let s=t.current,l=null==s?void 0:s.getContext("2d");s&&l&&(l.beginPath(),o(e))};return(0,l.jsxs)("div",{className:"relative border-2 border-dashed border-slate-300 rounded-lg bg-white h-40 w-full touch-none",children:[(0,l.jsx)("canvas",{ref:t,className:"w-full h-full cursor-crosshair",onMouseDown:x,onMouseUp:c,onMouseMove:o,onMouseLeave:c,onTouchStart:x,onTouchEnd:c,onTouchMove:o}),!i&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none text-slate-300",children:"Sign Here"}),i&&(0,l.jsx)("button",{onClick:()=>{let e=t.current,l=null==e?void 0:e.getContext("2d");e&&l&&(l.clearRect(0,0,e.width,e.height),d(!1),s(null))},className:"absolute top-2 right-2 p-1 bg-slate-100 text-slate-500 rounded hover:bg-slate-200",title:"Clear Signature",children:(0,l.jsx)(P.A,{size:16})})]})};var L=t(5626),O=t(639),z=t(9715),W=t(9451),_=t(5880),G=t(859),H=t(508),U=t(6485),B=t(2196),F=t(6835),K=t(2108),V=t(4033),X=t(5710),Y=t(8085),Z=t(9708),J=t(309);console.log("TaskDetail rendered");let q=e=>{let s=Array.isArray(e.steps)?e.steps:[];return{...e,steps:s.map(e=>({...e,attachments:Array.isArray(null==e?void 0:e.attachments)?e.attachments:[],comments:Array.isArray(null==e?void 0:e.comments)?e.comments:[]}))}},Q=e=>{var s,t,a,n,i,c,u,h,p,b;let{task:g,currentUser:j,onBack:f,onUpdateTask:v}=e,[w,y]=(0,r.useState)(()=>q(g)),[A,D]=(0,r.useState)(()=>{var e,s;let t=q(g);return(null==(e=t.steps.find(e=>null===e.isPassed))?void 0:e.id)||(null==(s=t.steps[0])?void 0:s.id)||null}),[k,I]=(0,r.useState)(!1),[E,T]=(0,r.useState)(""),[R,P]=(0,r.useState)({}),[Q,$]=(0,r.useState)(null),[ee,es]=(0,r.useState)(null),[et,el]=(0,r.useState)(!1),ea=j.role===d.Xh.ADMIN,er=w.status===d.nW.DEPLOYED,en=!!w.signedOff,ei="Admin Portal"===w.targetSystem?"https://www.easyorderadminstg.dksh.com":"https://www.easyorderstg.dksh.com",ed=(e,s)=>{var t;if(en)return;let l=(null!=(t=w.steps)?t:[]).map(t=>t.id===e?{...t,...s,completedAt:null!==s.isPassed?new Date().toLocaleString():void 0}:t),a=w.status,r={...w,steps:l};if(l.every(e=>!0===e.isPassed)&&w.status!==d.nW.DEPLOYED&&w.status!==d.nW.PASSED?r.status=d.nW.PASSED:l.some(e=>!1===e.isPassed)?r.status=d.nW.FAILED:l.some(e=>!0===e.isPassed)&&w.status===d.nW.PENDING&&(r.status=d.nW.IN_PROGRESS),y(r),v(r),r.status!==a&&ex(r.status),!0===s.isPassed){let s=w.steps.findIndex(s=>s.id===e),t=w.steps[s+1];t?D(t.id):D(null)}},ec=async e=>{let s=R[e];s&&s.trim()&&(await fetch("/api/tasks/".concat(w.id,"/comments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({body:s})})).ok&&(await eo(w.id),P({...R,[e]:""}))},eo=async e=>{let s=await fetch("/api/tasks/".concat(e),{cache:"no-store"});if(!s.ok)return;let t=q(await s.json());y(t),v(t)},ex=async e=>{await fetch("/api/tasks/".concat(w.id,"/status"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e})})};return(0,r.useEffect)(()=>{let e=q(g);y(e),eo(e.id)},[g.id]),(0,l.jsxs)("div",{className:"max-w-5xl mx-auto animate-fade-in pb-20 print:p-0 print:max-w-none",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6 print:hidden",children:[(0,l.jsxs)("button",{onClick:f,className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 transition-colors",children:[(0,l.jsx)(L.A,{size:18})," Back"]}),ea&&!er&&w.status===d.nW.PASSED&&(0,l.jsxs)("button",{onClick:()=>I(!0),className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors shadow-sm",children:[(0,l.jsx)(O.A,{size:16})," Deploy Feature"]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 relative overflow-hidden print:border-0 print:shadow-none",children:[er&&(0,l.jsxs)("div",{className:"absolute top-0 right-0 bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-bl-lg z-10 print:hidden",children:["DEPLOYED ",null==(s=w.deployment)?void 0:s.deployedAt]}),(0,l.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsx)(o,{type:"module",value:w.featureModule}),(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium border ".concat("Global"===w.scope?"bg-purple-50 text-purple-700 border-purple-100":"bg-slate-100 text-slate-600 border-slate-200"),children:[(0,l.jsx)(C.A,{size:12})," ",w.scope]}),w.crNumber&&(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium bg-orange-50 text-orange-700 border border-orange-100",children:[(0,l.jsx)(z.A,{size:12})," ",w.crNumber]})]}),(0,l.jsx)(o,{type:"status",value:w.status})]}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4 mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:w.title}),(0,l.jsx)("p",{className:"text-slate-600",children:w.description})]}),(0,l.jsxs)("a",{href:ei,target:"_blank",rel:"noreferrer",className:"flex-shrink-0 inline-flex items-center gap-2 px-5 py-3 bg-brand-600 text-white rounded-lg shadow-sm hover:bg-brand-700 transition-colors font-medium text-sm print:hidden",children:[(0,l.jsx)(W.A,{size:18})," Launch ",w.targetSystem,(0,l.jsx)(_.A,{size:14,className:"opacity-70"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t border-slate-100",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs text-slate-400 block mb-1",children:"Jira Ticket"}),(0,l.jsxs)("a",{href:"#",className:"flex items-center gap-1 text-sm font-medium text-blue-600 hover:underline",children:[(0,l.jsx)(G.A,{size:12})," ",w.jiraTicket||"N/A"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs text-slate-400 block mb-1",children:"Developer"}),(0,l.jsxs)("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-700",children:[(0,l.jsx)(H.A,{size:12})," ",w.developer||"Unassigned"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs text-slate-400 block mb-1",children:"Due Date"}),(0,l.jsxs)("span",{className:"flex items-center gap-1 text-sm font-medium text-slate-700",children:[(0,l.jsx)(U.A,{size:12})," ",w.dueDate]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs text-slate-400 block mb-1",children:"Priority"}),(0,l.jsx)(o,{type:"priority",value:w.priority})]})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden print:border-0 print:shadow-none",children:[(0,l.jsxs)("div",{className:"p-4 bg-slate-50 border-b border-slate-200 flex justify-between items-center print:bg-white print:border-b-2 print:border-slate-800",children:[(0,l.jsxs)("h3",{className:"font-semibold text-slate-900 flex items-center gap-2",children:[(0,l.jsx)(m.A,{size:18,className:"text-slate-400"})," Test Steps"]}),(0,l.jsxs)("div",{className:"text-xs font-medium text-slate-500",children:[(null!=(i=w.steps)?i:[]).filter(e=>!0===e.isPassed).length," / ",(null!=(c=w.steps)?c:[]).length," Steps Completed"]})]}),(0,l.jsx)("div",{className:"divide-y divide-slate-100",children:(null!=(u=w.steps)?u:[]).map((e,s)=>{var t,a,r,n;let i=A===e.id,d=!0===e.isPassed?"bg-emerald-100 border-emerald-200 text-emerald-700":!1===e.isPassed?"bg-rose-100 border-rose-200 text-rose-700":"bg-white border-slate-200 text-slate-500";return(0,l.jsxs)("div",{className:"transition-all outline-none ".concat(i?"bg-white":"bg-slate-50/30"," print:bg-white print:break-inside-avoid"),onPaste:s=>i&&((e,s)=>{if(en)return;let t=e.clipboardData.items;for(let l=0;l<t.length;l++)if(-1!==t[l].type.indexOf("image")){let a=t[l].getAsFile(),r=new FileReader;r.onload=e=>{var t,l;let a=null==(t=e.target)?void 0:t.result,r=(null!=(l=w.steps)?l:[]).find(e=>e.id===s);r&&ed(s,{attachments:[...r.attachments||[],a]})},a&&r.readAsDataURL(a),e.preventDefault()}})(s,e.id),tabIndex:i?0:-1,children:[(0,l.jsxs)("div",{onClick:()=>D(i?null:e.id),className:"p-4 flex items-center gap-4 cursor-pointer hover:bg-slate-50 print:cursor-default",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-full border flex items-center justify-center text-sm font-bold flex-shrink-0 ".concat(d),children:!0===e.isPassed?(0,l.jsx)(m.A,{size:16}):!1===e.isPassed?(0,l.jsx)(N.A,{size:16}):s+1}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"flex items-center gap-2 mb-1",children:(0,l.jsx)("p",{className:"text-sm font-medium ".concat(!0===e.isPassed?"text-slate-400 line-through":"text-slate-900"),children:e.description})}),e.completedAt&&(0,l.jsxs)("p",{className:"text-[10px] text-slate-400",children:["Executed: ",e.completedAt]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 print:hidden",children:[e.attachments&&e.attachments.length>0&&(0,l.jsxs)("span",{className:"flex items-center gap-1 text-xs text-slate-400 bg-slate-100 px-2 py-0.5 rounded-full",title:"Attachments",children:[(0,l.jsx)(B.A,{size:10})," ",e.attachments.length]}),(null!=(t=e.comments)?t:[]).length>0&&(0,l.jsxs)("span",{className:"flex items-center gap-1 text-xs text-slate-400 bg-slate-100 px-2 py-0.5 rounded-full",title:"Comments",children:[(0,l.jsx)(F.A,{size:10})," ",(null!=(a=e.comments)?a:[]).length]}),i?(0,l.jsx)(K.A,{size:16,className:"text-slate-400"}):(0,l.jsx)(V.A,{size:16,className:"text-slate-400"})]})]}),(i||en)&&(0,l.jsx)("div",{className:"px-4 pb-6 pt-0 animate-in slide-in-from-top-2",children:(0,l.jsxs)("div",{className:"ml-12 space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 print:bg-white print:border-slate-300",children:[(0,l.jsx)("span",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider mb-2 block",children:"Expected Result"}),(0,l.jsx)("p",{className:"text-sm text-slate-700",children:e.expectedResult})]}),e.testData&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("span",{className:"text-[10px] uppercase font-bold text-brand-600 tracking-wider mb-1 block flex items-center gap-1",children:[(0,l.jsx)(X.A,{size:10})," Test Data"]}),(0,l.jsx)("code",{className:"text-xs bg-slate-50 px-2 py-1.5 rounded border border-slate-200 text-slate-700 block font-mono",children:e.testData})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[en?e.actualResult&&(0,l.jsxs)("div",{className:"bg-white p-3 rounded border border-slate-200 text-sm text-slate-700 italic",children:[(0,l.jsx)("span",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider mb-1 block",children:"Actual Result"}),'"',e.actualResult,'"']}):(0,l.jsxs)("div",{className:"print:hidden",children:[(0,l.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide mb-1 block",children:"Actual Result"}),(0,l.jsx)("textarea",{className:"w-full text-sm rounded-lg border-slate-300 focus:ring-brand-500 focus:border-brand-500 min-h-[60px]",placeholder:"Describe observations...",value:e.actualResult||"",onChange:s=>ed(e.id,{actualResult:s.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide mb-2 block flex justify-between print:hidden",children:[(0,l.jsx)("span",{children:"Evidence"}),!en&&(0,l.jsx)("span",{className:"font-normal text-[10px] normal-case text-slate-400",children:"Ctrl+V to paste"})]}),e.attachments&&e.attachments.length>0&&(0,l.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:e.attachments.map((s,t)=>(0,l.jsxs)("div",{className:"relative w-16 h-16 rounded border border-slate-200 overflow-hidden group",children:[(0,l.jsx)("img",{src:s,alt:"Evidence",className:"w-full h-full object-cover cursor-pointer",onClick:()=>$(s)}),!en&&(0,l.jsx)("button",{onClick:s=>{s.stopPropagation(),((e,s)=>{var t;if(en)return;let l=(null!=(t=w.steps)?t:[]).find(s=>s.id===e);if(!l||!l.attachments)return;let a=[...l.attachments];a.splice(s,1),ed(e,{attachments:a})})(e.id,t)},className:"absolute top-0 right-0 bg-red-500 text-white p-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,l.jsx)(S.A,{size:12})})]},t))}),!en&&(0,l.jsxs)("div",{className:"border-2 border-dashed border-slate-200 rounded-lg p-3 flex flex-col items-center justify-center text-center cursor-pointer hover:bg-slate-50 hover:border-slate-300 transition-colors print:hidden",onClick:()=>{},children:[(0,l.jsx)(B.A,{size:16,className:"text-slate-400 mb-1"}),(0,l.jsx)("span",{className:"text-xs text-slate-500",children:"Paste image or click to upload"})]})]})]})]}),!en&&(0,l.jsx)("div",{className:"flex justify-end pt-2 border-t border-slate-50 print:hidden",children:(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("button",{onClick:s=>{s.stopPropagation(),ed(e.id,{isPassed:!1})},className:"px-4 py-2 rounded-lg text-xs font-bold border transition-colors flex items-center gap-2 ".concat(!1===e.isPassed?"bg-rose-600 text-white border-rose-600":"bg-white text-rose-600 border-rose-200 hover:bg-rose-50"),children:[(0,l.jsx)(N.A,{size:14})," FAIL"]}),(0,l.jsxs)("button",{onClick:s=>{s.stopPropagation(),ed(e.id,{isPassed:!0})},className:"px-4 py-2 rounded-lg text-xs font-bold border transition-colors flex items-center gap-2 ".concat(!0===e.isPassed?"bg-emerald-600 text-white border-emerald-600":"bg-white text-emerald-600 border-emerald-200 hover:bg-emerald-50"),children:[(0,l.jsx)(m.A,{size:14})," PASS"]})]})}),(null!=(r=e.comments)?r:[]).length>0&&(0,l.jsx)("div",{className:"bg-slate-50 rounded-lg p-3 space-y-2 mt-2 print:bg-white print:border print:border-slate-200",children:(null!=(n=e.comments)?n:[]).map(e=>(0,l.jsxs)("div",{className:"flex gap-2 text-xs",children:[(0,l.jsx)("span",{className:"font-bold text-slate-800",children:e.userId}),(0,l.jsx)("span",{className:"text-slate-600",children:e.text}),(0,l.jsx)("span",{className:"text-slate-400 ml-auto",children:e.createdAt})]},e.id))}),!en&&(0,l.jsxs)("div",{className:"flex gap-2 mt-2 print:hidden",children:[(0,l.jsx)("input",{type:"text",className:"flex-1 text-xs border-slate-200 rounded px-3 py-2 focus:ring-brand-500 focus:border-brand-500",placeholder:"Add a comment...",value:R[e.id]||"",onChange:s=>P({...R,[e.id]:s.target.value}),onKeyDown:s=>"Enter"===s.key&&ec(e.id)}),(0,l.jsx)("button",{onClick:()=>ec(e.id),className:"text-slate-400 hover:text-brand-600 p-2",children:(0,l.jsx)(Y.A,{size:14})})]})]})})]},e.id)})})]}),(0,l.jsx)("div",{className:"bg-slate-50 rounded-xl border border-slate-200 p-6 flex flex-col items-center justify-center text-center print:border-0 print:bg-white",children:en?(0,l.jsxs)("div",{className:"w-full flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-emerald-100 text-emerald-700 rounded-full flex items-center justify-center mb-3 print:hidden",children:(0,l.jsx)(Z.A,{size:24})}),(0,l.jsx)("h3",{className:"font-bold text-lg text-emerald-800",children:"Testing Completed & Signed"}),(0,l.jsxs)("p",{className:"text-sm text-slate-500 mt-1 mb-4",children:["Signed by ",null==(t=w.signedOff)?void 0:t.signedBy," on ",null==(a=w.signedOff)?void 0:a.signedAt]}),(null==(n=w.signedOff)?void 0:n.signatureData)&&(0,l.jsx)("div",{className:"border border-slate-200 rounded bg-white p-2",children:(0,l.jsx)("img",{src:w.signedOff.signatureData,alt:"Signature",className:"h-24 opacity-80"})}),(0,l.jsxs)("button",{onClick:()=>{window.print()},className:"mt-6 flex items-center gap-2 px-5 py-2.5 bg-slate-900 text-white rounded-lg hover:bg-slate-800 shadow-sm transition-colors print:hidden",children:[(0,l.jsx)(J.A,{size:16})," Download PDF Report"]})]}):(0,l.jsxs)("div",{className:"w-full max-w-md print:hidden",children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-900 mb-4",children:"Sign-off & Complete"}),(0,l.jsxs)("div",{className:"mb-4 text-left",children:[(0,l.jsx)("label",{className:"text-xs font-medium text-slate-700 mb-1 block",children:"Draw Signature"}),(0,l.jsx)(M,{onEnd:es})]}),(0,l.jsxs)("div",{className:"flex items-start gap-2 mb-6 text-left bg-blue-50 p-3 rounded-lg border border-blue-100",children:[(0,l.jsx)("input",{type:"checkbox",id:"ack",checked:et,onChange:e=>el(e.target.checked),className:"mt-0.5 rounded text-brand-600 focus:ring-brand-500 border-gray-300"}),(0,l.jsx)("label",{htmlFor:"ack",className:"text-xs text-blue-900 leading-tight cursor-pointer select-none",children:"I acknowledge that by signing this task, I confirm all steps are executed correctly. This task will be locked and cannot be edited further."})]}),(0,l.jsxs)("button",{onClick:()=>{if(!ee||!et)return;let e={...w,status:d.nW.PASSED,signedOff:{signedBy:j.name,signedAt:new Date().toLocaleString(),signatureData:ee}};y(e),v(e),ex(e.status)},disabled:(null!=(h=w.steps)?h:[]).some(e=>null===e.isPassed)||!ee||!et,className:"w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors ".concat(!(null!=(p=w.steps)?p:[]).some(e=>null===e.isPassed)&&ee&&et?"bg-slate-900 text-white hover:bg-slate-800 shadow-md":"bg-slate-200 text-slate-400 cursor-not-allowed"),children:[(0,l.jsx)(F.A,{size:16})," Sign & Complete Task"]}),(null!=(b=w.steps)?b:[]).some(e=>null===e.isPassed)&&(0,l.jsx)("p",{className:"text-xs text-rose-500 mt-2",children:"Please complete all test steps before signing."})]})})]}),k&&(0,l.jsx)("div",{className:"fixed inset-0 bg-slate-900/50 flex items-center justify-center z-50 print:hidden",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-md animate-in zoom-in-95",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-4 text-slate-900",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center",children:(0,l.jsx)(O.A,{size:20,className:"text-slate-800"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-bold text-lg",children:"Deploy to Production"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"Mark this feature as live"})]})]}),(0,l.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Release Version"}),(0,l.jsx)("input",{type:"text",className:"w-full rounded-md border-slate-300 focus:ring-slate-500 focus:border-slate-500",placeholder:"e.g. v2.4.0",value:E,onChange:e=>T(e.target.value)})]}),(0,l.jsx)("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-100",children:(0,l.jsxs)("p",{className:"text-xs text-yellow-800 flex items-start gap-2",children:[(0,l.jsx)(x.A,{size:14,className:"mt-0.5 flex-shrink-0"}),"This will notify all stakeholders that testing is complete and the feature is live."]})})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,l.jsx)("button",{onClick:()=>I(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-50 rounded-lg text-sm font-medium",children:"Cancel"}),(0,l.jsx)("button",{onClick:()=>{let e={...w,status:d.nW.DEPLOYED,deployment:{isDeployed:!0,deployedAt:new Date().toLocaleDateString(),deployedBy:j.name,releaseVersion:E||"v1.0.0"}};y(e),v(e),ex(e.status),I(!1)},className:"px-4 py-2 bg-slate-900 text-white hover:bg-slate-800 rounded-lg text-sm font-medium",children:"Confirm Deployment"})]})]})}),Q&&(0,l.jsxs)("div",{className:"fixed inset-0 bg-black/90 z-[60] flex items-center justify-center p-4 cursor-zoom-out print:hidden",onClick:()=>$(null),children:[(0,l.jsx)("img",{src:Q,alt:"Full View",className:"max-w-full max-h-full rounded-lg shadow-2xl"}),(0,l.jsx)("button",{className:"absolute top-4 right-4 text-white hover:text-slate-300",children:(0,l.jsx)(S.A,{size:32})})]})]})};var $=t(5917);let ee=()=>{let[e,s]=(0,r.useState)(1),[t,a]=(0,r.useState)(!1);return(0,l.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Import Tasks"}),(0,l.jsx)("p",{className:"text-slate-500",children:"Bulk upload UAT scenarios via Excel template."})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-10 relative",children:[(0,l.jsx)("div",{className:"absolute left-0 top-1/2 w-full h-0.5 bg-slate-200 -z-10"}),[1,2,3].map(s=>(0,l.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ".concat(e>=s?"bg-slate-900 text-white":"bg-white border-2 border-slate-200 text-slate-400"),children:e>s?(0,l.jsx)($.A,{size:14}):s},s))]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden min-h-[400px] flex flex-col",children:[1===e&&(0,l.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center animate-fade-in",children:[(0,l.jsxs)("div",{className:"w-full max-w-md h-48 border-2 border-dashed rounded-xl flex flex-col items-center justify-center transition-colors cursor-pointer ".concat(t?"border-blue-500 bg-blue-50":"border-slate-300 hover:border-slate-400"),onDragOver:e=>{e.preventDefault(),a(!0)},onDragLeave:()=>a(!1),onDrop:e=>{e.preventDefault(),a(!1),s(2)},onClick:()=>s(2),children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center text-slate-500 mb-4",children:(0,l.jsx)(w.A,{size:24})}),(0,l.jsx)("p",{className:"text-slate-900 font-medium",children:"Click to upload or drag and drop"}),(0,l.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:"XLSX or CSV (Max 5MB)"})]}),(0,l.jsxs)("div",{className:"mt-8 flex gap-2 text-sm text-blue-600 hover:underline cursor-pointer",children:[(0,l.jsx)(z.A,{size:16})," Download Template"]})]}),2===e&&(0,l.jsxs)("div",{className:"flex-1 p-6 animate-fade-in",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h3",{className:"font-semibold text-slate-900",children:"Preview & Validate"}),(0,l.jsx)("span",{className:"text-xs px-2 py-1 bg-green-50 text-green-700 rounded border border-green-100",children:"45 Valid Rows"})]}),(0,l.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:(0,l.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,l.jsx)("thead",{className:"bg-slate-50 text-slate-500 border-b border-slate-200",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-3 font-medium",children:"Title"}),(0,l.jsx)("th",{className:"p-3 font-medium",children:"Module"}),(0,l.jsx)("th",{className:"p-3 font-medium",children:"Priority"}),(0,l.jsx)("th",{className:"p-3 font-medium",children:"Country"})]})}),(0,l.jsxs)("tbody",{className:"divide-y divide-slate-100 text-slate-700",children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"p-3",children:"Verify Login Flow"}),(0,l.jsx)("td",{className:"p-3",children:"Auth"}),(0,l.jsx)("td",{className:"p-3",children:"High"}),(0,l.jsx)("td",{className:"p-3",children:"SG"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"p-3",children:"Checkout as Guest"}),(0,l.jsx)("td",{className:"p-3",children:"Ordering"}),(0,l.jsx)("td",{className:"p-3",children:"Medium"}),(0,l.jsx)("td",{className:"p-3",children:"SG"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"p-3",children:"Download PDF"}),(0,l.jsx)("td",{className:"p-3",children:"Report"}),(0,l.jsx)("td",{className:"p-3",children:"Low"}),(0,l.jsx)("td",{className:"p-3",children:"SG"})]}),(0,l.jsxs)("tr",{className:"bg-red-50/50",children:[(0,l.jsxs)("td",{className:"p-3 flex items-center gap-2",children:[(0,l.jsx)(x.A,{size:14,className:"text-red-500"})," Invalid Date Format"]}),(0,l.jsx)("td",{className:"p-3",children:"Admin"}),(0,l.jsx)("td",{className:"p-3",children:"-"}),(0,l.jsx)("td",{className:"p-3",children:"SG"})]})]})]})})]}),3===e&&(0,l.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-12 text-center animate-fade-in",children:[(0,l.jsx)("div",{className:"w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mb-6",children:(0,l.jsx)($.A,{size:32})}),(0,l.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:"Import Successful!"}),(0,l.jsx)("p",{className:"text-slate-500 mt-2 max-w-sm",children:"45 tasks have been created and assigned to stakeholders in Singapore."})]}),(0,l.jsxs)("div",{className:"p-4 border-t border-slate-200 bg-slate-50 flex justify-end gap-3",children:[e>1&&e<3&&(0,l.jsx)("button",{onClick:()=>s(e-1),className:"px-4 py-2 text-slate-600 hover:text-slate-900 font-medium text-sm",children:"Cancel"}),e<3&&(0,l.jsxs)("button",{onClick:()=>s(e+1),className:"px-6 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition-colors font-medium text-sm flex items-center gap-2",children:[2===e?"Confirm Import":"Next"," ",(0,l.jsx)(p.A,{size:16})]})]})]})]})},es=e=>{var s;let{initialView:t,initialSelectedTaskId:o=null,onRouteChange:x}=e,m=(0,a.useRouter)(),{data:u,status:h}=(0,n.useSession)(),[p,b]=(0,r.useState)(null),[j,f]=(0,r.useState)([]),[N,w]=(0,r.useState)(null!=t?t:"LOGIN"),[y,A]=(0,r.useState)(o),[D,k]=(0,r.useState)(c._z),[S,C]=(0,r.useState)(c.xW),[I,T]=(0,r.useState)(""),[P,M]=(0,r.useState)(""),[L,O]=(0,r.useState)(null);(0,r.useEffect)(()=>{if("loading"===h)return;if(!(null==u?void 0:u.user)){b(null),w("LOGIN");return}let e="ADMIN"===u.user.role?d.Xh.ADMIN:d.Xh.STAKEHOLDER;b({id:u.user.id,name:u.user.name||u.user.email||"User",email:u.user.email||"",role:e,countryCode:u.user.countryCode||"SG",avatarUrl:u.user.image||void 0}),w(null!=t?t:e===d.Xh.ADMIN?"DASHBOARD_ADMIN":"DASHBOARD_STAKEHOLDER")},[u,h,t]),(0,r.useEffect)(()=>{if(!(null==u?void 0:u.user))return void f([]);(async()=>{let e=await fetch("/api/tasks",{cache:"no-store"});if(!e.ok)return f([]);f(await e.json())})()},[null==u||null==(s=u.user)?void 0:s.id]),(0,r.useEffect)(()=>{!(null==u?void 0:u.user)||!y||j.find(e=>e.id===y)||(async()=>{let e=await fetch("/api/tasks/".concat(y),{cache:"no-store"});if(!e.ok)return;let s=await e.json();f(e=>e.some(e=>e.id===s.id)?e:[s,...e])})()},[y,null==u?void 0:u.user,j]);let z=async e=>{var s;if(e.preventDefault(),!I||!P)return;O(null);let t=await (0,n.signIn)("credentials",{email:I,password:P,redirect:!1});if(!t||t.error)return void O("Invalid email or password. Please try again.");let l=await (0,n.getSession)();if("ADMIN"===(null==l||null==(s=l.user)?void 0:s.role))return void m.push("/admin/dashboard");m.push("/")},W=e=>{A(e.id),w("TASK_DETAIL"),null==x||x("TASK_DETAIL",e.id)},_=e=>{w(e),"TASK_DETAIL"!==e&&A(null),null==x||x(e,"TASK_DETAIL"===e?y:null)},G=y?j.find(e=>e.id===y):null;return p&&"LOGIN"!==N?(0,l.jsxs)(i.P,{currentUser:p,onLogout:()=>{(0,n.signOut)({redirect:!1}),b(null),w("LOGIN"),A(null),T(""),M(""),null==x||x("LOGIN")},currentView:N,onNavigate:_,children:["DASHBOARD_STAKEHOLDER"===N&&(0,l.jsx)(g,{tasks:j,onSelectTask:W,currentUserCountry:p.countryCode}),"DASHBOARD_ADMIN"===N&&(0,l.jsx)(v,{tasks:j,onSelectTask:W,onManageTasks:()=>_("ADMIN_TASK_MANAGEMENT")}),"ADMIN_TASK_MANAGEMENT"===N&&(0,l.jsx)(E,{tasks:j,onImport:()=>_("IMPORT_WIZARD"),onEdit:W,onAddTask:e=>{f(s=>[...e,...s])},availableCountries:D,availableModules:S}),"ADMIN_DATABASE"===N&&(0,l.jsx)(R,{countries:D,modules:S,onUpdateCountries:k,onUpdateModules:C}),"TASK_DETAIL"===N&&y&&G&&(0,l.jsx)(Q,{task:G,currentUser:p,onBack:()=>_(p.role===d.Xh.ADMIN?"DASHBOARD_ADMIN":"DASHBOARD_STAKEHOLDER"),onUpdateTask:e=>{f(s=>s.some(s=>s.id===e.id)?s.map(s=>s.id===e.id?e:s):[e,...s])}}),"IMPORT_WIZARD"===N&&(0,l.jsx)(ee,{})]}):(0,l.jsxs)("div",{className:"min-h-screen bg-slate-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,l.jsx)("div",{className:"flex justify-center mb-6",children:(0,l.jsx)("div",{className:"w-16 h-16 bg-brand-500 rounded-xl flex items-center justify-center shadow-lg",children:(0,l.jsx)("span",{className:"text-white font-bold text-2xl tracking-wider",children:"CTT"})})}),(0,l.jsx)("h2",{className:"text-center text-3xl font-extrabold text-slate-900 tracking-tight",children:"CTT"}),(0,l.jsx)("p",{className:"mt-2 text-center text-sm text-slate-500 font-medium",children:"Cuba Try Test - UAT Management"})]}),(0,l.jsxs)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[(0,l.jsxs)("div",{className:"bg-white py-10 px-6 shadow-xl border border-slate-100 sm:rounded-2xl",children:[(0,l.jsxs)("form",{className:"space-y-6",onSubmit:z,children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700",children:"Email address"}),(0,l.jsx)("input",{type:"text",className:"mt-1 appearance-none block w-full px-3 py-2 border border-slate-300 rounded-lg shadow-sm placeholder-slate-400 focus:outline-none focus:ring-brand-500 focus:border-brand-500 sm:text-sm",placeholder:"user@dksh.com",value:I,onChange:e=>T(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-700",children:"Password"}),(0,l.jsx)("input",{type:"password",className:"mt-1 appearance-none block w-full px-3 py-2 border border-slate-300 rounded-lg shadow-sm placeholder-slate-400 focus:outline-none focus:ring-brand-500 focus:border-brand-500 sm:text-sm",placeholder:"••••••••",value:P,onChange:e=>M(e.target.value)})]}),L&&(0,l.jsx)("div",{className:"text-sm text-rose-600 bg-rose-50 border border-rose-100 rounded-lg px-3 py-2",children:L}),(0,l.jsx)("div",{children:(0,l.jsx)("button",{type:"submit",className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-xl shadow-sm text-sm font-semibold text-white bg-slate-900 hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-900 transition-all",children:"Sign in"})})]}),(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,l.jsx)("div",{className:"w-full border-t border-slate-200"})}),(0,l.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,l.jsx)("span",{className:"px-2 bg-white text-slate-500",children:"Tip: Use your assigned account to sign in"})})]})})]}),(0,l.jsx)("p",{className:"text-center text-xs text-slate-400 mt-6",children:"\xa9 2023 Corporate IT Team"})]})]})};function et(e){let{initialView:s,initialTaskId:t=null}=e,r=(0,a.useRouter)();return(0,l.jsx)(es,{initialView:s,initialSelectedTaskId:t,onRouteChange:(e,s)=>{switch(e){case"LOGIN":case"DASHBOARD_STAKEHOLDER":r.push("/");return;case"DASHBOARD_ADMIN":r.push("/admin/dashboard");return;case"ADMIN_TASK_MANAGEMENT":r.push("/admin/tasks");return;case"ADMIN_DATABASE":r.push("/admin/database");return;case"IMPORT_WIZARD":r.push("/import");return;case"TASK_DETAIL":if(s)return void r.push("/tasks/".concat(s));r.push("/");return;default:return r.push("/"),e}}})}},8368:(e,s,t)=>{t.d(s,{Xh:()=>r,bx:()=>a,nW:()=>l});var l=function(e){return e.PENDING="Pending",e.IN_PROGRESS="In Progress",e.PASSED="Passed",e.FAILED="Failed",e.BLOCKED="Blocked",e.DEPLOYED="Deployed",e}({}),a=function(e){return e.LOW="Low",e.MEDIUM="Medium",e.HIGH="High",e.CRITICAL="Critical",e}({}),r=function(e){return e.ADMIN="Admin",e.STAKEHOLDER="Stakeholder",e}({})},9580:(e,s,t)=>{t.d(s,{_z:()=>a,o1:()=>n,uY:()=>i,xW:()=>r});var l=t(8368);let a=[{code:"TH",name:"Thailand",color:"bg-pink-100 text-pink-700"},{code:"SG",name:"Singapore",color:"bg-cyan-100 text-cyan-700"},{code:"VN",name:"Vietnam",color:"bg-yellow-100 text-yellow-700"},{code:"MY",name:"Malaysia",color:"bg-blue-100 text-blue-700"},{code:"TW",name:"Taiwan",color:"bg-emerald-100 text-emerald-700"},{code:"HK",name:"Hong Kong",color:"bg-red-100 text-red-700"}],r=["Ordering","Pricing","Reporting","Integration","Account","Promotions","Returns"],n=[{id:"u1",name:"Sarah Chen",email:"sarah.c@company.com",role:l.Xh.STAKEHOLDER,countryCode:"SG",avatarUrl:"https://picsum.photos/100/100"},{id:"u2",name:"Alex Miller",email:"alex.m@company.com",role:l.Xh.ADMIN,countryCode:"SG",avatarUrl:"https://picsum.photos/101/101"}];l.nW.PENDING,l.bx.HIGH,l.nW.IN_PROGRESS,l.bx.MEDIUM,l.nW.FAILED,l.bx.CRITICAL,l.nW.DEPLOYED,l.bx.LOW,l.nW.BLOCKED,l.bx.HIGH;let i=[{id:"n1",userId:"u2",type:"ALERT",message:'Task "SAP Integration" marked as FAILED in Thailand.',time:"10 mins ago",isRead:!1,relatedTaskId:"t3"},{id:"n2",userId:"u2",type:"SUCCESS",message:'Sarah Chen completed "User Profile Update".',time:"1 hour ago",isRead:!1,relatedTaskId:"t4"},{id:"n3",userId:"u2",type:"MENTION",message:'New comment from Alex: "Please check font support..."',time:"2 hours ago",isRead:!0,relatedTaskId:"t2"},{id:"n4",userId:"u1",type:"INFO",message:'New task assigned: "Verify Order Creation".',time:"3 hours ago",isRead:!1,relatedTaskId:"t1"},{id:"n5",userId:"u1",type:"ALERT",message:'Task "Check PDF Invoice" is due tomorrow.',time:"5 hours ago",isRead:!0,relatedTaskId:"t2"}]}}]);